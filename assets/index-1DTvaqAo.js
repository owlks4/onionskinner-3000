(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(e){if(e.ep)return;e.ep=!0;const o=s(e);fetch(e.href,o)}})();const d=1920;let r=0,m=!1,c=document.getElementById("video"),a=document.getElementById("canvas"),v=document.getElementById("startbutton"),b=document.getElementById("photos-list"),u=document.getElementById("onionskins"),h=document.getElementById("countdown"),p=document.getElementById("seconds-input");v.onclick=n=>{k(),n.preventDefault()};navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(n=>{c.srcObject=n,c.play()}).catch(n=>{console.error("Error: "+n)});c.oncanplay=n=>{m||(r=c.videoHeight/(c.videoWidth/d),isNaN(r)&&(r=d/(4/3)),c.setAttribute("width",d),c.setAttribute("height",r),a.setAttribute("width",d),a.setAttribute("height",r),m=!0)};const w=n=>new Promise(t=>setTimeout(t,n));async function k(){if(p.value!="0")for(let t=p.value;t>=0;t--)h.innerText=t+"",await w(1e3);const n=a.getContext("2d");if(r){a.width=d,a.height=r,n.drawImage(c,0,0,d,r);const t=a.toDataURL("image/png");let s=document.createElement("div");s.style="display:block; width:100%;";let i=document.createElement("img");s.appendChild(i),i.setAttribute("src",t),i.setAttribute("class","prospectivePhoto");let e=document.createElement("input");e.setAttribute("type","checkbox"),e.id="cb-"+t,e.style="position:relative;",e.onclick=l=>{l.currentTarget.checked?f(i):g(i)},s.appendChild(e),i.onclick=l=>{e.checked=!e.checked,e.checked?f(i):g(i)};let o=document.createElement("label");o.style="font-size:0.9em;",o.innerText="Tick to use the above photo as an onionskin",o.setAttribute("for",e.id),s.appendChild(o),b.appendChild(s)}else clearphoto();h.innerText=""}function f(n){let t=document.createElement("img");t.id=n.src,t.src=n.src,u.appendChild(t),y()}function y(){let n=1/(u.childElementCount+1);for(const t of u.children)t.style="height:100%;position:absolute;transform:translate(-50%,0%);opacity:"+n}function g(n){document.getElementById(n.src).remove(),y()}window.addEventListener("beforeunload",function(n){var t=`Are you sure you want to leave?
Make sure you've right clicked and saved any images you want to keep before leaving.`;return(n||window.event).returnValue=t,t});
